<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.grid.dao.UserScoreDao">

    <resultMap id="userScoreMap" type="com.grid.entity.UserScoreBean">
        <result column="uid" property="uid"/>
        <result column="name" property="name"/>
    </resultMap>

    <select id="getUserScoreByParam" resultType="com.grid.entity.UserScoreBean">
        SELECT uid, sum(real_price) as tempScore
        FROM charge
        <where>
            <if test="uid != null and uid != ''">AND uid = #{uid}</if>
            <if test="dateStart != null and dateStart != ''">AND create_time <![CDATA[>=]]> #{dateStart}</if>
            <if test="dateEnd != null and dateEnd != ''">AND create_time <![CDATA[<=]]> #{dateEnd}</if>
        </where>
        GROUP BY uid
    </select>

    <select id="getUidAndName" parameterType="com.grid.entity.UserScoreBean" resultType="com.grid.entity.UserScoreBean">
        SELECT uid, name
        FROM user
        <where>
            <if test="name != null and name != ''">AND name = #{name}</if>
        </where>
        limit #{startnum},#{getrows}
    </select>

    <select id="getUserNum" parameterType="com.grid.entity.UserScoreBean" resultType="int">
        SELECT COUNT(*)
        FROM user
        <where>
            <if test="name != null and name != ''">AND name = #{name}</if>
        </where>
    </select>
</mapper>

